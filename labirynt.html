<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Labirynt Miłości</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      position: relative;
      font-family: 'Quicksand', sans-serif;
    }

    .maze {
      width: 80vw;
      height: 80vh;
      background: #222;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
    }

    .path {
      position: absolute;
      background: #fff;
      border-radius: 10px;
    }

    /* Przykład trasy (prosta, kręta droga) */
    .path1 { top: 10%; left: 5%; width: 90%; height: 10%; }
    .path2 { top: 10%; left: 85%; width: 10%; height: 60%; }
    .path3 { top: 60%; left: 20%; width: 75%; height: 10%; }
    .path4 { top: 60%; left: 20%; width: 10%; height: 25%; }

    .player {
      width: 30px;
      height: 30px;
      background: pink;
      border-radius: 50%;
      position: absolute;
      top: 10%;
      left: 5%;
      z-index: 5;
      pointer-events: none;
      transition: top 0.05s, left 0.05s;
    }

    .start-img, .end-img {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 10px;
      object-fit: cover;
      z-index: 3;
    }

    .start-img {
      top: 10%;
      left: 5%;
    }

    .end-img {
      bottom: 5%;
      left: 20%;
    }

    #screamer {
      position: fixed;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      transform: translate(-50%, -50%);
      z-index: 100;
      transition: all 0.5s ease;
    }

    #screamer.active {
      width: 300px;
      height: auto;
    }

    audio {
      display: none;
    }
  </style>
</head>
<body>
  <div class="maze" id="maze">
    <div class="path path1"></div>
    <div class="path path2"></div>
    <div class="path path3"></div>
    <div class="path path4"></div>

    <img class="start-img" src="start.jpg" alt="Start" />
    <img class="end-img" src="meta.jpg" alt="Meta" />

    <div class="player" id="player"></div>
  </div>

  <img src="screamer.jpg" id="screamer" alt="BUUU!" />
  <audio id="buuSound" src="buuu.mp3"></audio>

  <script>
    const player = document.getElementById('player');
    const maze = document.getElementById('maze');
    const buuSound = document.getElementById('buuSound');
    const screamer = document.getElementById('screamer');

    let playing = false;

    // Ustawienia pozycji startowej
    let startX = maze.offsetLeft + maze.offsetWidth * 0.05;
    let startY = maze.offsetTop + maze.offsetHeight * 0.10;

    function resetPlayer() {
      player.style.left = "5%";
      player.style.top = "10%";
    }

    function checkCollision(x, y) {
      const el = document.elementFromPoint(x, y);
      return !(el && el.classList.contains("path"));
    }

    function checkWin(x, y) {
      const end = document.querySelector('.end-img').getBoundingClientRect();
      return x > end.left && x < end.right && y > end.top && y < end.bottom;
    }

    function checkScreamerZone(x, y) {
      const mazeRect = maze.getBoundingClientRect();
      return x > mazeRect.left + mazeRect.width * 0.5 && x < mazeRect.left + mazeRect.width * 0.6;
    }

    document.addEventListener("mousemove", move);
    document.addEventListener("touchmove", move, { passive: false });

    function move(e) {
      e.preventDefault();
      let x = e.clientX || (e.touches && e.touches[0].clientX);
      let y = e.clientY || (e.touches && e.touches[0].clientY);

      player.style.left = (x - maze.offsetLeft - 15) + "px";
      player.style.top = (y - maze.offsetTop - 15) + "px";

      if (checkCollision(x, y)) {
        resetPlayer();
      } else if (!playing && checkScreamerZone(x, y)) {
        playing = true;
        buuSound.play();
        screamer.classList.add("active");
        setTimeout(() => {
          screamer.classList.remove("active");
        }, 2500);
      } else if (checkWin(x, y)) {
        window.location.href = "kolejna-strona.html";
      }
    }

    // Start po załadowaniu
    window.addEventListener("load", resetPlayer);
  </script>
</body>
</html>
